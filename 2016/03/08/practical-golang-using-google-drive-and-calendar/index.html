<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Practical Golang: Using Google Drive and Calendar | Jacob Martin</title><meta name=keywords content><meta name=description content="Introduction Integrating Google services into your app can lead to a lot of nice features for your users, and can create a seamless experience for them. In this tutorial we’ll learn how to use the most useful functionalities of Google Calendar and Google Drive.
The theory To begin with, we should understand the methodology of using the Google API in Golang. For most of their API’s I’ve skimmed through it works like that:"><meta name=author content="Jacob Martin"><link rel=canonical href=https://jacobmartins.com/2016/03/08/practical-golang-using-google-drive-and-calendar/><link crossorigin=anonymous href=/assets/css/stylesheet.min.35cd0f65a15cafa92372b8313deef5960aae04b90ad722f2bbf509eb0468137e.css integrity="sha256-Nc0PZaFcr6kjcrgxPe71lgquBLkK1yLyu/UJ6wRoE34=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.e85ad0406048e8176e1c7661b25d5c69297ddfe41dc4124cf75ecb99a4f7b3d1.js integrity="sha256-6FrQQGBI6BduHHZhsl1caSl93+QdxBJM917LmaT3s9E=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://jacobmartins.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jacobmartins.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jacobmartins.com/favicon-32x32.png><link rel=apple-touch-icon href=https://jacobmartins.com/apple-touch-icon.png><link rel=mask-icon href=https://jacobmartins.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.101.0"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-74339391-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Practical Golang: Using Google Drive and Calendar"><meta property="og:description" content="Introduction Integrating Google services into your app can lead to a lot of nice features for your users, and can create a seamless experience for them. In this tutorial we’ll learn how to use the most useful functionalities of Google Calendar and Google Drive.
The theory To begin with, we should understand the methodology of using the Google API in Golang. For most of their API’s I’ve skimmed through it works like that:"><meta property="og:type" content="article"><meta property="og:url" content="https://jacobmartins.com/2016/03/08/practical-golang-using-google-drive-and-calendar/"><meta property="og:image" content="https://jacobmartins.com/images/avatar.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-03-08T13:47:01+00:00"><meta property="article:modified_time" content="2016-03-08T13:47:01+00:00"><meta property="og:site_name" content="Jacob Martin"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jacobmartins.com/images/avatar.jpg"><meta name=twitter:title content="Practical Golang: Using Google Drive and Calendar"><meta name=twitter:description content="Introduction Integrating Google services into your app can lead to a lot of nice features for your users, and can create a seamless experience for them. In this tutorial we’ll learn how to use the most useful functionalities of Google Calendar and Google Drive.
The theory To begin with, we should understand the methodology of using the Google API in Golang. For most of their API’s I’ve skimmed through it works like that:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://jacobmartins.com/posts/"},{"@type":"ListItem","position":2,"name":"Practical Golang: Using Google Drive and Calendar","item":"https://jacobmartins.com/2016/03/08/practical-golang-using-google-drive-and-calendar/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Practical Golang: Using Google Drive and Calendar","name":"Practical Golang: Using Google Drive and Calendar","description":"Introduction Integrating Google services into your app can lead to a lot of nice features for your users, and can create a seamless experience for them. In this tutorial we’ll learn how to use the most useful functionalities of Google Calendar and Google Drive.\nThe theory To begin with, we should understand the methodology of using the Google API in Golang. For most of their API’s I’ve skimmed through it works like that:","keywords":[],"articleBody":"Introduction Integrating Google services into your app can lead to a lot of nice features for your users, and can create a seamless experience for them. In this tutorial we’ll learn how to use the most useful functionalities of Google Calendar and Google Drive.\nThe theory To begin with, we should understand the methodology of using the Google API in Golang. For most of their API’s I’ve skimmed through it works like that:\nCreate an OAuth2 client from the OAuth2 access token. Use the client to create an app service, this will be our interface we’ll use to communicate with Google services. We create a request object and set the needed parameters. We start the action, usually using the Do() function on the request object. After you learn it for one Google service, it will be trivial for you to use it for any other.\nDependencies Here we will need the Google Calendar and Google Drive libraries, both of which we need version 3 of. (the newest at the moment)\nSo make sure to:\ngo get google.golang.org/api/calendar/v3 go get google.golang.org/api/drive/v3 The basic structure For both of our apps we’ll need the same basic OAuth2 app structure. You can learn more about it in my previous article\npackage main import ( \"fmt\" \"net/http\" \"golang.org/x/oauth2\" \"os\" \"golang.org/x/oauth2/google\" \"golang.org/x/net/context\" \"time\" ) var ( googleOauthConfig = \u0026oauth2.Config{ RedirectURL: \"http://localhost:3000/GoogleCallback\", ClientID: os.Getenv(\"googlekey\"), // from https://console.developers.google.com/project//apiui/credential ClientSecret: os.Getenv(\"googlesecret\"), // from https://console.developers.google.com/project//apiui/credential Scopes: []string{}, Endpoint: google.Endpoint, } // Some random string, random for each request oauthStateString = \"random\" ) const htmlIndex = ` Log in with Google ` func main() { http.HandleFunc(\"/\", handleMain) http.HandleFunc(\"/GoogleLogin\", handleGoogleLogin) http.HandleFunc(\"/GoogleCallback\", handleGoogleCallback) fmt.Println(http.ListenAndServe(\":3000\", nil)) } func handleMain(w http.ResponseWriter, r *http.Request) { fmt.Fprintf(w, htmlIndex) } func handleGoogleLogin(w http.ResponseWriter, r *http.Request) { url := googleOauthConfig.AuthCodeURL(oauthStateString) http.Redirect(w, r, url, http.StatusTemporaryRedirect) } func handleGoogleCallback(w http.ResponseWriter, r *http.Request) { state := r.FormValue(\"state\") if state != oauthStateString { fmt.Printf(\"invalid oauth state, expected '%s', got '%s'\\n\", oauthStateString, state) http.Redirect(w, r, \"/\", http.StatusTemporaryRedirect) return } code := r.FormValue(\"code\") token, err := googleOauthConfig.Exchange(oauth2.NoContext, code) if err != nil { fmt.Printf(\"oauthConf.Exchange() failed with '%s'\\n\", err) http.Redirect(w, r, \"/\", http.StatusTemporaryRedirect) return } client := oauth2.NewClient(context.Background(), oauth2.StaticTokenSource(token)) } There is one thing I haven’t covered in my previous blog post, namely the last line:\nclient := oauth2.NewClient(context.Background(), oauth2.StaticTokenSource(token)) We need an OAuth2 client to use the Google API, so we create one. It takes a context, for lack of which we just use the background context. It also needs a token source. As we only want to make one request and know that this token will suffice we create a static token source which will always generate the same token which we’ve passed to it.\nCreating the Calendar app. Preperation First, as described in my previous article, you should enable the Google Calendar API in the Google Cloud Console for you app.\nAlso, we’ll need to ask for permission, so add the https://www.googleapis.com/auth/calendar scope to our googleOauthConfig:\ngoogleOauthConfig = \u0026oauth2.Config{ RedirectURL: \"http://localhost:3000/GoogleCallback\", ClientID: os.Getenv(\"googlekey\"), // from https://console.developers.google.com/project//apiui/credential ClientSecret: os.Getenv(\"googlesecret\"), // from https://console.developers.google.com/project//apiui/credential Scopes: []string{\"https://www.googleapis.com/auth/calendar\"}, Endpoint: google.Endpoint, } Remember to import google.golang.org/api/calendar/v3\nThe main code We’ll add everything we write right after creating our OAuth2 client.\nFirst, as I described before, we’ll need an app service, here it will be the calendar service, so let’s create it!\nclient := oauth2.NewClient(context.Background(), oauth2.StaticTokenSource(token)) calendarService, err := calendar.New(client) if err != nil { fmt.Fprintln(w, err) return } It just uses the OAuth client to create the service and errors out if something goes wrong.\nListing events Now we will create a request, add a few optional parameters to it and start it. We’ll build it up step by step.\ncalendarService, err := calendar.New(client) if err != nil { fmt.Fprintln(w, err) return } calendarService.Events.List(\"primary\") This creates a request to list all events in your primary calendar. You could also name a specific calendar, but using primary will take the primary calendar of that user.\nSo… I think we don’t really care about the events 5 years ago. So let’s only take the upcoming ones.\ncalendarService.Events.List(\"primary\").TimeMin(time.Now().Format(time.RFC3339)) We add an option TimeMin which takes a DateTime by string… No idea why it isn’t a nice struct like time.DateTime. You also need to format it as a string in the RFC3339 format.\nOk… but that could be a lot of events, so we’ll just take the 5 first:\ncalendarService.Events.List(\"primary\").TimeMin(time.Now().Format(time.RFC3339)).MaxResults(5) Now we just have to Do() it, and store the results:\ncalendarEvents, err := calendarService.Events.List(\"primary\").TimeMin(time.Now().Format(time.RFC3339)).MaxResults(5).Do() if err != nil { fmt.Fprintln(w, err) return } How can we now do something with the results? Simple! :\ncalendarEvents, err := calendarService.Events.List(\"primary\").TimeMin(time.Now().Format(time.RFC3339)).MaxResults(5).Do() if err != nil { fmt.Fprintln(w, err) return } if len(calendarEvents.Items) \u003e 0 { for _, i := range calendarEvents.Items { fmt.Fprintln(w, i.Summary, \" \", i.Start.DateTime) } } We access a list of events using the Items field in the calendarEvents variable, if there is at least one element, then for each element we write the summary and start time to the response writer using a for range loop.\nCreating an event Ok, we already know how to list events, now let’s create an event!\nFirst, we need an event object:\nif len(calendarEvents.Items) \u003e 0 { for _, i := range calendarEvents.Items { fmt.Fprintln(w, i.Summary, \" \", i.Start.DateTime) } } newEvent := calendar.Event{ Summary: \"Testevent\", Start: \u0026calendar.EventDateTime{DateTime: time.Date(2016, 3, 11, 12, 24, 0, 0, time.UTC).Format(time.RFC3339)}, End: \u0026calendar.EventDateTime{DateTime: time.Date(2016, 3, 11, 13, 24, 0, 0, time.UTC).Format(time.RFC3339)}, } We create an Event struct and pass in the summary – title of the event.\nWe also pass the start and finish DateTime. We create a date using the stdlib time package, and then convert it to a string in the RFC3339 format. There are tons of other optional fields you can specify if you want to.\nNext we need to create an insert request object:\nnewEvent := calendar.Event{ Summary: \"Testevent\", Start: \u0026calendar.EventDateTime{DateTime: time.Date(2016, 3, 11, 12, 24, 0, 0, time.UTC).Format(time.RFC3339)}, End: \u0026calendar.EventDateTime{DateTime: time.Date(2016, 3, 11, 13, 24, 0, 0, time.UTC).Format(time.RFC3339)}, } calendarService.Events.Insert(\"primary\", \u0026newEvent) The Insert request takes two arguments, the calendar name and an event object.\nAs usual we neeed to Do() the request! and saving the resulting created event can also come handy in the future:\ncreatedEvent, err := calendarService.Events.Insert(\"primary\", \u0026newEvent).Do() if err != nil { fmt.Fprintln(w, err) return } In the end let’s just print some kind of confirmation to the user:\nfmt.Fprintln(w, \"New event in your calendar: \\\"\", createdEvent.Summary, \"\\\" starting at \", createdEvent.Start.DateTime) Hint You can define the event ID yourself before creating it, but you can also let the Google Calendar service generate an ID for us as we did.\nCreating the Drive app Preperation First, enable the Google Drive API in the Google Cloud Console\nAgain we will need to ask the user for permission. So we have to use the https://www.googleapis.com/auth/drive and https://www.googleapis.com/auth/drive.file scopes:\ngoogleOauthConfig = \u0026oauth2.Config{ RedirectURL: \"http://localhost:3000/GoogleCallback\", ClientID: os.Getenv(\"googlekey\"), // from https://console.developers.google.com/project//apiui/credential ClientSecret: os.Getenv(\"googlesecret\"), // from https://console.developers.google.com/project//apiui/credential Scopes: []string{\"https://www.googleapis.com/auth/drive\", \"https://www.googleapis.com/auth/drive.file\"}, Endpoint: google.Endpoint, } Remember to import google.golang.org/api/drive/v3″\nThe main code Again we need to start from our basic OAuth2 app structure with an OAuth2 client, and create an app service. Here, this will be the Drive service:\nclient := oauth2.NewClient(context.Background(), oauth2.StaticTokenSource(token)) driveService, err := drive.New(client) if err != nil { fmt.Fprintln(w, err) return } Listing files Ok, to begin with let’s learn how to list files from the Google Drive. There is an important concept you should understand before we start. Whenever we request a list of files from Google Drive, those can literally be thousands of files. That’s why we get one page of files, which includes files metadata, not the content, and a NextPageToken, which we can use to get the next page.\nAs before with the calendar app, we create a list request.\ndriveService, err := drive.New(client) if err != nil { fmt.Fprintln(w, err) return } driveService.Files.List() But we can also set an option. The ordering for example:\ndriveService.Files.List().OrderBy(\"name\") Ok, now let’s Do() it and save the results:\nmyFilesList, err := driveService.Files.List().OrderBy(\"name\").Do() if err != nil { fmt.Fprintf(w, \"Couldn't retrieve files \", err) } As I wrote before, this is one page of files, now let’s go over it:\nif len(myFilesList.Files) \u003e 0 { for _, i := range myFilesList.Files { fmt.Fprintln(w, i.Name, \" \", i.Id) } } else { fmt.Fprintln(w, \"No files found.\") } We check if there are any files, and if there are, we range over them printing the name and Id of each one, else we print that there are none.\nNow, let’s get more pages, it’s the myFilesList.NextPageToken holding the token for the next page. If it is an empty string, then this was the last page. While it is present we load new pages into our myFilesList variable.\nfor myFilesList.NextPageToken != \"\" { myFilesList, err = driveService.Files.List().OrderBy(\"name\").PageToken(myFilesList.NextPageToken).Do() if err != nil { fmt.Fprintf(w, \"Couldn't retrieve files \", err) break } fmt.Fprintln(w, \"Next Page: !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\") if len(myFilesList.Files) \u003e 0 { for _, i := range myFilesList.Files { fmt.Fprintln(w, i.Name, \" \", i.Id) } } else { fmt.Fprintln(w, \"No files found.\") } } To retrieve the next page we add the PageToken option to our file listing request\nmyFilesList, err = driveService.Files.List().OrderBy(\"name\").PageToken(myFilesList.NextPageToken).Do() Whenever we start printing the new page, we notify a user that a new page just started. Later we check if we have any files, and if we do, then we range over them as before, printing the names and Id’s\nCreating a file We already know how to list files in our Google Drive. Now let’s learn how to create a file and add some content to it!\nFirst, we need to create the file metadata:\nfor myFilesList.NextPageToken != \"\" { myFilesList, err = driveService.Files.List().OrderBy(\"name\").PageToken(myFilesList.NextPageToken).Do() if err != nil { fmt.Fprintf(w, \"Couldn't retrieve files \", err) break } fmt.Fprintln(w, \"Next Page: !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\") if len(myFilesList.Files) \u003e 0 { for _, i := range myFilesList.Files { fmt.Fprintln(w, i.Name, \" \", i.Id) } } else { fmt.Fprintln(w, \"No files found.\") } } myFile := drive.File{Name: \"cats.png\"} Again, the Id will be generated for us if we do not provide any.\nPutting the file into Google Drive is pretty easy now. We create a create request, referencing our file metadata in it:\nmyFile := drive.File{Name: \"cats.png\"} driveService.Files.Create(\u0026myFile) and Do() it, saving the results:\ncreatedFile, err := driveService.Files.Create(\u0026myFile).Do() if err != nil { fmt.Fprintf(w, \"Couldn't create file \", err) } Ok, if you started this code, you would get a cats.png file. However, it’s empty. So let’s add some data to it!\nTo add it, we’ll first need some data. We can load it from a file:\ncreatedFile, err := driveService.Files.Create(\u0026myFile).Do() if err != nil { fmt.Fprintf(w, \"Couldn't create file \", err) } myImage, err := os.Open(\"/tmp/image.png\") if err != nil { fmt.Fprintln(w, err) } Now we have to create the updated file metadata:\nmyImage, err := os.Open(\"/tmp/image.png\") if err != nil { fmt.Fprintln(w, err) } updatedFile := drive.File{Name: \"catsUpdated.png\"} We have to construct an update request:\ndriveService.Files.Update(createdFile.Id, \u0026updatedFile) Here we specify the Id of the file to modify, and the new metadata. We’ll now add the data to the update request, and Do() it, checking for errors and ignoring the result.\n_, err = driveService.Files.Update(createdFile.Id, \u0026updatedFile).Media(myImage).Do() if err != nil { fmt.Fprintln(w, err) } fmt.Fprintln(w, createdFile.Id) In the end we send the new file id to the user.\nHint You could add the Media option already to the create request if you wanted.\nConclusion I suppose this was a good short introduction into the structure of the Google API. After learning these, you should have few to no problems using the other API’s.\nHave fun integrating it into your app!\n","wordCount":"1920","inLanguage":"en","datePublished":"2016-03-08T13:47:01Z","dateModified":"2016-03-08T13:47:01Z","author":{"@type":"Person","name":"Jacob Martin"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jacobmartins.com/2016/03/08/practical-golang-using-google-drive-and-calendar/"},"publisher":{"@type":"Organization","name":"Jacob Martin","logo":{"@type":"ImageObject","url":"https://jacobmartins.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://jacobmartins.com/ accesskey=h title="Jacob Martin (Alt + H)">Jacob Martin</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://jacobmartins.com/ title="About Me"><span>About Me</span></a></li><li><a href=https://jacobmartins.com/archive title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://jacobmartins.com/>Home</a>&nbsp;»&nbsp;<a href=https://jacobmartins.com/posts/>Posts</a></div><h1 class=post-title>Practical Golang: Using Google Drive and Calendar</h1><div class=post-meta>March 8, 2016&nbsp;·&nbsp;10 min&nbsp;·&nbsp;Jacob Martin&nbsp;|&nbsp;<a href=https://github.com/cube2222/cube2222.github.io/content/posts/2016-03-08-practical-golang-using-google-drive-and-calendar.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>Integrating Google services into your app can lead to a lot of nice features for your users, and can create a seamless experience for them. In this tutorial we’ll learn how to use the most useful functionalities of <strong><em>Google Calendar</em></strong> and <strong><em>Google Drive</em></strong>.</p><h2 id=the-theory>The theory<a hidden class=anchor aria-hidden=true href=#the-theory>#</a></h2><p>To begin with, we should understand the methodology of using the <strong><em>Google API</em></strong> in Golang. For most of their API’s I’ve skimmed through it works like that:</p><ol><li>Create an <strong>OAuth2 client</strong> from the OAuth2 <em>access token</em>.</li><li>Use the client to create an app service, this will be our interface we’ll use to communicate with Google services.</li><li>We create a request object and set the needed parameters.</li><li>We start the action, usually using the <em>Do()</em> function on the request object.</li></ol><p>After you learn it for one Google service, it will be trivial for you to use it for any other.</p><h2 id=dependencies>Dependencies<a hidden class=anchor aria-hidden=true href=#dependencies>#</a></h2><p>Here we will need the Google Calendar and Google Drive libraries, both of which we need version 3 of. (the newest at the moment)</p><p>So make sure to:</p><pre><code>go get google.golang.org/api/calendar/v3
go get google.golang.org/api/drive/v3
</code></pre><h2 id=the-basic-structure>The basic structure<a hidden class=anchor aria-hidden=true href=#the-basic-structure>#</a></h2><p>For both of our apps we’ll need the same basic OAuth2 app structure. You can learn more about it in <a href=https://jacobmartins.com/2016/02/29/getting-started-with-oauth2-in-go/>my previous article</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;net/http&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;golang.org/x/oauth2&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;os&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;golang.org/x/oauth2/google&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;golang.org/x/net/context&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> (
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>googleOauthConfig</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>oauth2</span>.<span style=color:#a6e22e>Config</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>RedirectURL</span>:    <span style=color:#e6db74>&#34;http://localhost:3000/GoogleCallback&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ClientID</span>:     <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Getenv</span>(<span style=color:#e6db74>&#34;googlekey&#34;</span>), <span style=color:#75715e>// from https://console.developers.google.com/project/&lt;your-project-id&gt;/apiui/credential
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>ClientSecret</span>: <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Getenv</span>(<span style=color:#e6db74>&#34;googlesecret&#34;</span>), <span style=color:#75715e>// from https://console.developers.google.com/project/&lt;your-project-id&gt;/apiui/credential
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Scopes</span>:       []<span style=color:#66d9ef>string</span>{},
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Endpoint</span>:     <span style=color:#a6e22e>google</span>.<span style=color:#a6e22e>Endpoint</span>,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span><span style=color:#75715e>// Some random string, random for each request
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>oauthStateString</span> = <span style=color:#e6db74>&#34;random&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>htmlIndex</span> = <span style=color:#e6db74>`&lt;html&gt;&lt;body&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&lt;a href=&#34;/GoogleLogin&#34;&gt;Log in with Google&lt;/a&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&lt;/body&gt;&lt;/html&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>HandleFunc</span>(<span style=color:#e6db74>&#34;/&#34;</span>, <span style=color:#a6e22e>handleMain</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>HandleFunc</span>(<span style=color:#e6db74>&#34;/GoogleLogin&#34;</span>, <span style=color:#a6e22e>handleGoogleLogin</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>HandleFunc</span>(<span style=color:#e6db74>&#34;/GoogleCallback&#34;</span>, <span style=color:#a6e22e>handleGoogleCallback</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ListenAndServe</span>(<span style=color:#e6db74>&#34;:3000&#34;</span>, <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>handleMain</span>(<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ResponseWriter</span>, <span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>htmlIndex</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>handleGoogleLogin</span>(<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ResponseWriter</span>, <span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>url</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>googleOauthConfig</span>.<span style=color:#a6e22e>AuthCodeURL</span>(<span style=color:#a6e22e>oauthStateString</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Redirect</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>r</span>, <span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusTemporaryRedirect</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>handleGoogleCallback</span>(<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ResponseWriter</span>, <span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>state</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>FormValue</span>(<span style=color:#e6db74>&#34;state&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>state</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>oauthStateString</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;invalid oauth state, expected &#39;%s&#39;, got &#39;%s&#39;\n&#34;</span>, <span style=color:#a6e22e>oauthStateString</span>, <span style=color:#a6e22e>state</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Redirect</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>r</span>, <span style=color:#e6db74>&#34;/&#34;</span>, <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusTemporaryRedirect</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>code</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>FormValue</span>(<span style=color:#e6db74>&#34;code&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>token</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>googleOauthConfig</span>.<span style=color:#a6e22e>Exchange</span>(<span style=color:#a6e22e>oauth2</span>.<span style=color:#a6e22e>NoContext</span>, <span style=color:#a6e22e>code</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;oauthConf.Exchange() failed with &#39;%s&#39;\n&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Redirect</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>r</span>, <span style=color:#e6db74>&#34;/&#34;</span>, <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusTemporaryRedirect</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>client</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>oauth2</span>.<span style=color:#a6e22e>NewClient</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Background</span>(), <span style=color:#a6e22e>oauth2</span>.<span style=color:#a6e22e>StaticTokenSource</span>(<span style=color:#a6e22e>token</span>))
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>There is one thing I haven’t covered in my previous blog post, namely the last line:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>client</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>oauth2</span>.<span style=color:#a6e22e>NewClient</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Background</span>(), <span style=color:#a6e22e>oauth2</span>.<span style=color:#a6e22e>StaticTokenSource</span>(<span style=color:#a6e22e>token</span>))
</span></span></code></pre></div><p>We need an <strong><em>OAuth2 client</em></strong> to use the Google API, so we create one. It takes a <em>context</em>, for lack of which we just use the <em>background context</em>. It also needs a <em>token source</em>. As we only want to make one request and know that this token will suffice we create a <em>static token source</em> which will always generate the same <em>token</em> which we’ve passed to it.</p><h2 id=creating-the-calendar-app>Creating the Calendar app.<a hidden class=anchor aria-hidden=true href=#creating-the-calendar-app>#</a></h2><h3 id=preperation>Preperation<a hidden class=anchor aria-hidden=true href=#preperation>#</a></h3><p>First, as described in <a href=https://jacobmartins.com/2016/02/29/getting-started-with-oauth2-in-go/>my previous article</a>, you should enable the Google Calendar API in the <strong><em>Google Cloud Console</em></strong> for you app.</p><p>Also, we’ll need to ask for permission, so add the <strong><em><a href=https://www.googleapis.com/auth/calendar>https://www.googleapis.com/auth/calendar</a></em></strong> scope to our googleOauthConfig:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>googleOauthConfig</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>oauth2</span>.<span style=color:#a6e22e>Config</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>RedirectURL</span>:    <span style=color:#e6db74>&#34;http://localhost:3000/GoogleCallback&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ClientID</span>:     <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Getenv</span>(<span style=color:#e6db74>&#34;googlekey&#34;</span>), <span style=color:#75715e>// from https://console.developers.google.com/project/&lt;your-project-id&gt;/apiui/credential
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>ClientSecret</span>: <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Getenv</span>(<span style=color:#e6db74>&#34;googlesecret&#34;</span>), <span style=color:#75715e>// from https://console.developers.google.com/project/&lt;your-project-id&gt;/apiui/credential
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Scopes</span>:       []<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;https://www.googleapis.com/auth/calendar&#34;</span>},
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Endpoint</span>:     <span style=color:#a6e22e>google</span>.<span style=color:#a6e22e>Endpoint</span>,
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>Remember to import google.golang.org/api/calendar/v3</p><h3 id=the-main-code>The main code<a hidden class=anchor aria-hidden=true href=#the-main-code>#</a></h3><p>We’ll add everything we write right after creating our OAuth2 client.</p><p>First, as I described before, we’ll need an app service, here it will be the calendar service, so let’s create it!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>client</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>oauth2</span>.<span style=color:#a6e22e>NewClient</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Background</span>(), <span style=color:#a6e22e>oauth2</span>.<span style=color:#a6e22e>StaticTokenSource</span>(<span style=color:#a6e22e>token</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>calendarService</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>calendar</span>.<span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>client</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>It just uses the OAuth client to create the service and errors out if something goes wrong.</p><h4 id=listing-events>Listing events<a hidden class=anchor aria-hidden=true href=#listing-events>#</a></h4><p>Now we will create a request, add a few optional parameters to it and start it. We’ll build it up step by step.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>calendarService</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>calendar</span>.<span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>client</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>calendarService</span>.<span style=color:#a6e22e>Events</span>.<span style=color:#a6e22e>List</span>(<span style=color:#e6db74>&#34;primary&#34;</span>)
</span></span></code></pre></div><p>This creates a request to list all events in your primary calendar. You could also name a specific calendar, but using <em>primary</em> will take the primary calendar of that user.</p><p>So… I think we don’t really care about the events 5 years ago. So let’s only take the upcoming ones.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>calendarService</span>.<span style=color:#a6e22e>Events</span>.<span style=color:#a6e22e>List</span>(<span style=color:#e6db74>&#34;primary&#34;</span>).<span style=color:#a6e22e>TimeMin</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>().<span style=color:#a6e22e>Format</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>RFC3339</span>))
</span></span></code></pre></div><p>We add an option <em>TimeMin</em> which takes a <em>DateTime</em> by string… No idea why it isn’t a nice struct like <em>time.DateTime</em>. You also need to format it as a string in the RFC3339 format.</p><p>Ok… but that could be a lot of events, so we’ll just take the 5 first:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>calendarService</span>.<span style=color:#a6e22e>Events</span>.<span style=color:#a6e22e>List</span>(<span style=color:#e6db74>&#34;primary&#34;</span>).<span style=color:#a6e22e>TimeMin</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>().<span style=color:#a6e22e>Format</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>RFC3339</span>)).<span style=color:#a6e22e>MaxResults</span>(<span style=color:#ae81ff>5</span>)
</span></span></code></pre></div><p>Now we just have to <strong><em>Do()</em></strong> it, and store the results:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>calendarEvents</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>calendarService</span>.<span style=color:#a6e22e>Events</span>.<span style=color:#a6e22e>List</span>(<span style=color:#e6db74>&#34;primary&#34;</span>).<span style=color:#a6e22e>TimeMin</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>().<span style=color:#a6e22e>Format</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>RFC3339</span>)).<span style=color:#a6e22e>MaxResults</span>(<span style=color:#ae81ff>5</span>).<span style=color:#a6e22e>Do</span>()
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>How can we now do something with the results? Simple! :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>calendarEvents</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>calendarService</span>.<span style=color:#a6e22e>Events</span>.<span style=color:#a6e22e>List</span>(<span style=color:#e6db74>&#34;primary&#34;</span>).<span style=color:#a6e22e>TimeMin</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>().<span style=color:#a6e22e>Format</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>RFC3339</span>)).<span style=color:#a6e22e>MaxResults</span>(<span style=color:#ae81ff>5</span>).<span style=color:#a6e22e>Do</span>()
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>calendarEvents</span>.<span style=color:#a6e22e>Items</span>) &gt; <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>calendarEvents</span>.<span style=color:#a6e22e>Items</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Summary</span>, <span style=color:#e6db74>&#34; &#34;</span>, <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Start</span>.<span style=color:#a6e22e>DateTime</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We access a list of events using the <strong><em>Items</em></strong> field in the <em>calendarEvents</em> variable, if there is at least one element, then for each element we write the <em>summary</em> and <em>start time</em> to the <em>response writer</em> using a <em>for range</em> loop.</p><h4 id=creating-an-event>Creating an event<a hidden class=anchor aria-hidden=true href=#creating-an-event>#</a></h4><p>Ok, we already know how to list events, now let’s create an event!<br>First, we need an event object:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>calendarEvents</span>.<span style=color:#a6e22e>Items</span>) &gt; <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>calendarEvents</span>.<span style=color:#a6e22e>Items</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Summary</span>, <span style=color:#e6db74>&#34; &#34;</span>, <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Start</span>.<span style=color:#a6e22e>DateTime</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>newEvent</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>calendar</span>.<span style=color:#a6e22e>Event</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Summary</span>: <span style=color:#e6db74>&#34;Testevent&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Start</span>: <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>calendar</span>.<span style=color:#a6e22e>EventDateTime</span>{<span style=color:#a6e22e>DateTime</span>: <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#ae81ff>2016</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>24</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>UTC</span>).<span style=color:#a6e22e>Format</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>RFC3339</span>)},
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>End</span>: <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>calendar</span>.<span style=color:#a6e22e>EventDateTime</span>{<span style=color:#a6e22e>DateTime</span>: <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#ae81ff>2016</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>13</span>, <span style=color:#ae81ff>24</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>UTC</span>).<span style=color:#a6e22e>Format</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>RFC3339</span>)},
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We create an Event struct and pass in the <strong><em>summary</em></strong> – title of the event.<br>We also pass the start and finish <strong><em>DateTime</em></strong>. We create a <em>date</em> using the stdlib <em>time</em> package, and then convert it to a string in the RFC3339 format. There are tons of other optional fields you can specify if you want to.</p><p>Next we need to create an <strong><em>insert</em></strong> request object:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>newEvent</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>calendar</span>.<span style=color:#a6e22e>Event</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Summary</span>: <span style=color:#e6db74>&#34;Testevent&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Start</span>: <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>calendar</span>.<span style=color:#a6e22e>EventDateTime</span>{<span style=color:#a6e22e>DateTime</span>: <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#ae81ff>2016</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>24</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>UTC</span>).<span style=color:#a6e22e>Format</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>RFC3339</span>)},
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>End</span>: <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>calendar</span>.<span style=color:#a6e22e>EventDateTime</span>{<span style=color:#a6e22e>DateTime</span>: <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#ae81ff>2016</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>13</span>, <span style=color:#ae81ff>24</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>UTC</span>).<span style=color:#a6e22e>Format</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>RFC3339</span>)},
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>calendarService</span>.<span style=color:#a6e22e>Events</span>.<span style=color:#a6e22e>Insert</span>(<span style=color:#e6db74>&#34;primary&#34;</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>newEvent</span>)
</span></span></code></pre></div><p>The <strong><em>Insert</em></strong> request takes two arguments, the calendar name and an event object.</p><p>As usual we neeed to <strong><em>Do()</em></strong> the request! and saving the resulting created event can also come handy in the future:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>createdEvent</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>calendarService</span>.<span style=color:#a6e22e>Events</span>.<span style=color:#a6e22e>Insert</span>(<span style=color:#e6db74>&#34;primary&#34;</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>newEvent</span>).<span style=color:#a6e22e>Do</span>()
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In the end let’s just print some kind of confirmation to the user:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;New event in your calendar: \&#34;&#34;</span>, <span style=color:#a6e22e>createdEvent</span>.<span style=color:#a6e22e>Summary</span>, <span style=color:#e6db74>&#34;\&#34; starting at &#34;</span>, <span style=color:#a6e22e>createdEvent</span>.<span style=color:#a6e22e>Start</span>.<span style=color:#a6e22e>DateTime</span>)
</span></span></code></pre></div><h3 id=hint>Hint<a hidden class=anchor aria-hidden=true href=#hint>#</a></h3><p>You can define the event <strong><em>ID</em></strong> yourself before creating it, but you can also let the <em>Google Calendar</em> service generate an <strong><em>ID</em></strong> for us as we did.</p><h2 id=creating-the-drive-app>Creating the Drive app<a hidden class=anchor aria-hidden=true href=#creating-the-drive-app>#</a></h2><h3 id=preperation-1>Preperation<a hidden class=anchor aria-hidden=true href=#preperation-1>#</a></h3><p>First, enable the Google Drive API in the <strong><em>Google Cloud Console</em></strong></p><p>Again we will need to ask the user for permission. So we have to use the <a href=https://www.googleapis.com/auth/drive>https://www.googleapis.com/auth/drive</a> and <a href=https://www.googleapis.com/auth/drive.file>https://www.googleapis.com/auth/drive.file</a> scopes:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>googleOauthConfig</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>oauth2</span>.<span style=color:#a6e22e>Config</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>RedirectURL</span>:    <span style=color:#e6db74>&#34;http://localhost:3000/GoogleCallback&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ClientID</span>:     <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Getenv</span>(<span style=color:#e6db74>&#34;googlekey&#34;</span>), <span style=color:#75715e>// from https://console.developers.google.com/project/&lt;your-project-id&gt;/apiui/credential
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>ClientSecret</span>: <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Getenv</span>(<span style=color:#e6db74>&#34;googlesecret&#34;</span>), <span style=color:#75715e>// from https://console.developers.google.com/project/&lt;your-project-id&gt;/apiui/credential
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Scopes</span>:       []<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;https://www.googleapis.com/auth/drive&#34;</span>, <span style=color:#e6db74>&#34;https://www.googleapis.com/auth/drive.file&#34;</span>},
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Endpoint</span>:     <span style=color:#a6e22e>google</span>.<span style=color:#a6e22e>Endpoint</span>,
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>Remember to import google.golang.org/api/drive/v3″</p><h3 id=the-main-code-1>The main code<a hidden class=anchor aria-hidden=true href=#the-main-code-1>#</a></h3><p>Again we need to start from our basic OAuth2 app structure with an OAuth2 client, and create an app service. Here, this will be the <strong><em>Drive service</em></strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>client</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>oauth2</span>.<span style=color:#a6e22e>NewClient</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Background</span>(), <span style=color:#a6e22e>oauth2</span>.<span style=color:#a6e22e>StaticTokenSource</span>(<span style=color:#a6e22e>token</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>driveService</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>drive</span>.<span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>client</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=listing-files>Listing files<a hidden class=anchor aria-hidden=true href=#listing-files>#</a></h4><p>Ok, to begin with let’s learn how to list files from the <strong><em>Google Drive</em></strong>. There is an important concept you should understand before we start. Whenever we request a list of files from <em>Google Drive</em>, those can literally be thousands of files. That’s why we get one page of files, which includes files metadata, not the content, and a <strong><em>NextPageToken</em></strong>, which we can use to get the next page.</p><p>As before with the calendar app, we create a list request.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>driveService</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>drive</span>.<span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>client</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>driveService</span>.<span style=color:#a6e22e>Files</span>.<span style=color:#a6e22e>List</span>()
</span></span></code></pre></div><p>But we can also set an option. The ordering for example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>driveService</span>.<span style=color:#a6e22e>Files</span>.<span style=color:#a6e22e>List</span>().<span style=color:#a6e22e>OrderBy</span>(<span style=color:#e6db74>&#34;name&#34;</span>)
</span></span></code></pre></div><p>Ok, now let’s <strong><em>Do()</em></strong> it and save the results:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>myFilesList</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>driveService</span>.<span style=color:#a6e22e>Files</span>.<span style=color:#a6e22e>List</span>().<span style=color:#a6e22e>OrderBy</span>(<span style=color:#e6db74>&#34;name&#34;</span>).<span style=color:#a6e22e>Do</span>()
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Couldn&#39;t retrieve files &#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>As I wrote before, this is one page of files, now let’s go over it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>myFilesList</span>.<span style=color:#a6e22e>Files</span>) &gt; <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>myFilesList</span>.<span style=color:#a6e22e>Files</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Name</span>, <span style=color:#e6db74>&#34; &#34;</span>, <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Id</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;No files found.&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We check if there are any files, and if there are, we range over them printing the <em>name</em> and <em>Id</em> of each one, else we print that there are none.</p><p>Now, let’s get more pages, it’s the <strong><em>myFilesList.NextPageToken</em></strong> holding the token for the next page. If it is an empty string, then this was the last page. While it is present we load new pages into our <em>myFilesList</em> variable.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>myFilesList</span>.<span style=color:#a6e22e>NextPageToken</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>myFilesList</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>driveService</span>.<span style=color:#a6e22e>Files</span>.<span style=color:#a6e22e>List</span>().<span style=color:#a6e22e>OrderBy</span>(<span style=color:#e6db74>&#34;name&#34;</span>).<span style=color:#a6e22e>PageToken</span>(<span style=color:#a6e22e>myFilesList</span>.<span style=color:#a6e22e>NextPageToken</span>).<span style=color:#a6e22e>Do</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Couldn&#39;t retrieve files &#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Next Page: !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>myFilesList</span>.<span style=color:#a6e22e>Files</span>) &gt; <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>myFilesList</span>.<span style=color:#a6e22e>Files</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Name</span>, <span style=color:#e6db74>&#34; &#34;</span>, <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Id</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;No files found.&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>To retrieve the next page we add the <strong><em>PageToken</em></strong> option to our file listing request</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span>    <span style=color:#a6e22e>myFilesList</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>driveService</span>.<span style=color:#a6e22e>Files</span>.<span style=color:#a6e22e>List</span>().<span style=color:#a6e22e>OrderBy</span>(<span style=color:#e6db74>&#34;name&#34;</span>).<span style=color:#a6e22e>PageToken</span>(<span style=color:#a6e22e>myFilesList</span>.<span style=color:#a6e22e>NextPageToken</span>).<span style=color:#a6e22e>Do</span>()
</span></span></code></pre></div><p>Whenever we start printing the new page, we notify a user that a new page just started. Later we check if we have any files, and if we do, then we range over them as before, printing the <em>names</em> and <em>Id’s</em></p><h4 id=creating-a-file>Creating a file<a hidden class=anchor aria-hidden=true href=#creating-a-file>#</a></h4><p>We already know how to list files in our <em>Google Drive</em>. Now let’s learn how to create a file and add some content to it!</p><p>First, we need to create the file metadata:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>myFilesList</span>.<span style=color:#a6e22e>NextPageToken</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>myFilesList</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>driveService</span>.<span style=color:#a6e22e>Files</span>.<span style=color:#a6e22e>List</span>().<span style=color:#a6e22e>OrderBy</span>(<span style=color:#e6db74>&#34;name&#34;</span>).<span style=color:#a6e22e>PageToken</span>(<span style=color:#a6e22e>myFilesList</span>.<span style=color:#a6e22e>NextPageToken</span>).<span style=color:#a6e22e>Do</span>()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Couldn&#39;t retrieve files &#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Next Page: !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>myFilesList</span>.<span style=color:#a6e22e>Files</span>) &gt; <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>myFilesList</span>.<span style=color:#a6e22e>Files</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Name</span>, <span style=color:#e6db74>&#34; &#34;</span>, <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>Id</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;No files found.&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>myFile</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>drive</span>.<span style=color:#a6e22e>File</span>{<span style=color:#a6e22e>Name</span>: <span style=color:#e6db74>&#34;cats.png&#34;</span>}
</span></span></code></pre></div><p>Again, the <em>Id</em> will be generated for us if we do not provide any.</p><p>Putting the file into <em>Google Drive</em> is pretty easy now. We create a <em>create request</em>, referencing our file metadata in it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>myFile</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>drive</span>.<span style=color:#a6e22e>File</span>{<span style=color:#a6e22e>Name</span>: <span style=color:#e6db74>&#34;cats.png&#34;</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>driveService</span>.<span style=color:#a6e22e>Files</span>.<span style=color:#a6e22e>Create</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>myFile</span>)
</span></span></code></pre></div><p>and <strong><em>Do()</em></strong> it, saving the results:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>createdFile</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>driveService</span>.<span style=color:#a6e22e>Files</span>.<span style=color:#a6e22e>Create</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>myFile</span>).<span style=color:#a6e22e>Do</span>()
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Couldn&#39;t create file &#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Ok, if you started this code, you would get a <strong><em>cats.png</em></strong> file. However, it’s empty. So let’s add some data to it!</p><p>To add it, we’ll first need some data. We can load it from a file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>createdFile</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>driveService</span>.<span style=color:#a6e22e>Files</span>.<span style=color:#a6e22e>Create</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>myFile</span>).<span style=color:#a6e22e>Do</span>()
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Couldn&#39;t create file &#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>myImage</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Open</span>(<span style=color:#e6db74>&#34;/tmp/image.png&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now we have to create the updated file metadata:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>myImage</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Open</span>(<span style=color:#e6db74>&#34;/tmp/image.png&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>updatedFile</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>drive</span>.<span style=color:#a6e22e>File</span>{<span style=color:#a6e22e>Name</span>: <span style=color:#e6db74>&#34;catsUpdated.png&#34;</span>}
</span></span></code></pre></div><p>We have to construct an update request:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>driveService</span>.<span style=color:#a6e22e>Files</span>.<span style=color:#a6e22e>Update</span>(<span style=color:#a6e22e>createdFile</span>.<span style=color:#a6e22e>Id</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>updatedFile</span>)
</span></span></code></pre></div><p>Here we specify the <strong><em>Id</em></strong> of the file to modify, and the new metadata. We’ll now add the data to the update request, and <strong><em>Do()</em></strong> it, checking for errors and ignoring the result.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>driveService</span>.<span style=color:#a6e22e>Files</span>.<span style=color:#a6e22e>Update</span>(<span style=color:#a6e22e>createdFile</span>.<span style=color:#a6e22e>Id</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>updatedFile</span>).<span style=color:#a6e22e>Media</span>(<span style=color:#a6e22e>myImage</span>).<span style=color:#a6e22e>Do</span>()
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintln</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>createdFile</span>.<span style=color:#a6e22e>Id</span>)
</span></span></code></pre></div><p>In the end we send the new file id to the user.</p><h4 id=hint-1>Hint<a hidden class=anchor aria-hidden=true href=#hint-1>#</a></h4><p>You could add the <strong><em>Media</em></strong> option already to the create request if you wanted.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>I suppose this was a good short introduction into the structure of the <strong><em>Google API</em></strong>. After learning these, you should have few to no problems using the other API’s.</p><p>Have fun integrating it into your app!</p></div><footer class=post-footer><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Practical Golang: Using Google Drive and Calendar on twitter" href="https://twitter.com/intent/tweet/?text=Practical%20Golang%3a%20Using%20Google%20Drive%20and%20Calendar&url=https%3a%2f%2fjacobmartins.com%2f2016%2f03%2f08%2fpractical-golang-using-google-drive-and-calendar%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Practical Golang: Using Google Drive and Calendar on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fjacobmartins.com%2f2016%2f03%2f08%2fpractical-golang-using-google-drive-and-calendar%2f&title=Practical%20Golang%3a%20Using%20Google%20Drive%20and%20Calendar&summary=Practical%20Golang%3a%20Using%20Google%20Drive%20and%20Calendar&source=https%3a%2f%2fjacobmartins.com%2f2016%2f03%2f08%2fpractical-golang-using-google-drive-and-calendar%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Practical Golang: Using Google Drive and Calendar on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fjacobmartins.com%2f2016%2f03%2f08%2fpractical-golang-using-google-drive-and-calendar%2f&title=Practical%20Golang%3a%20Using%20Google%20Drive%20and%20Calendar"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Practical Golang: Using Google Drive and Calendar on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fjacobmartins.com%2f2016%2f03%2f08%2fpractical-golang-using-google-drive-and-calendar%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Practical Golang: Using Google Drive and Calendar on whatsapp" href="https://api.whatsapp.com/send?text=Practical%20Golang%3a%20Using%20Google%20Drive%20and%20Calendar%20-%20https%3a%2f%2fjacobmartins.com%2f2016%2f03%2f08%2fpractical-golang-using-google-drive-and-calendar%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Practical Golang: Using Google Drive and Calendar on telegram" href="https://telegram.me/share/url?text=Practical%20Golang%3a%20Using%20Google%20Drive%20and%20Calendar&url=https%3a%2f%2fjacobmartins.com%2f2016%2f03%2f08%2fpractical-golang-using-google-drive-and-calendar%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://jacobmartins.com/>Jacob Martin</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>